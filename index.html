<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Andrew Bruner | Website Builder</title>
</head>
<body>
  <header>
    <nav>
      <h1>Andrew Bruner</h1>
      <ul>
        <li><a href="#about">About</a></li>
        <li><a href="#projects">Projects</a></li>
        <li><a href="#weblog">Weblog</a></li>
      </ul>
    </nav>
  </header>
  <main>
    <section id="about">
      <h2>Hello. I'm Andrew.</h2>
      <p>I build affordable websites for freelancers and small businesses.</p>
    </section>
    <section id="projects">
      <h2>Projects</h2>
      <ul>
        <li><a href="https://github.com/andrewbruner/fsjs-techdegree-unit-01">Random Quote Generator</a></li>
        <li><a href="https://github.com/andrewbruner/fsjs-techdegree-unit-02">List Pagination and Filtering</a></li>
        <li><a href="https://github.com/andrewbruner/fsjs-techdegree-unit-03">Interactive Form</a></li>
        <li><a href="https://github.com/andrewbruner/fsjs-techdegree-unit-04">Object-Oriented Programming (OOP) Gameshow App</a></li>
        <li><a href="https://github.com/andrewbruner/fsjs-techdegree-unit-05">Public API Requests</a></li>
        <li><a href="https://github.com/andrewbruner/fsjs-techdegree-unit-06">Static Node.js and Express Site</a></li>
        <li><a href="https://github.com/andrewbruner/fsjs-techdegree-unit-07">React Gallery App</a></li>
        <li><a href="https://github.com/andrewbruner/fsjs-techdegree-unit-08">SQL Library Manager</a></li>
        <li><a href="https://github.com/andrewbruner/fsjs-techdegree-unit-09">REST API</a></li>
        <li><a href="https://github.com/andrewbruner/fsjs-techdegree-unit-10">Full Stack App with React and REST API</a></li>
    </section>
    <section id="weblog">
      <h2>Weblog</h2>
      <ul>
      </ul>
    </section>
  </main>
  <footer>
    <small>&copy; Andrew Bruner</small>
  </footer>

  <!-- Script to insert weblog posts -->
  <script>
    let url = "https://api.hashnode.com";
    let query = `
      query {
        user(username: "andrewbruner") {
          publication {
            posts(page: 0) {
              title
              slug
              dateAdded
              brief
            }
          }
        }
      }`;
    let params = {
      method: 'post',
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        query: query,
      }),
    };

    fetch(url, params)
      .then(res => res.json())
      .then(data => {
        let weblogUl = document.querySelector('#weblog ul');
        for (let i = 0; i < 3; i++) {
          let post = data.data.user.publication.posts[i];
          // Post Title/Link
          let postA = document.createElement('a');
          postA.href = `https://andrewbruner.hashnode.dev/${post.slug}`;
          postA.textContent = post.title;
          let postH3 = document.createElement('h3');
          let postLi = document.createElement('li');
          postH3.appendChild(postA);
          postLi.appendChild(postH3);
          // Post Date
          let postSmall = document.createElement('small')
          let date = new Date(post.dateAdded).toDateString();
          postSmall.textContent = date;
          postLi.appendChild(postSmall);
          // Post Brief
          let postP = document.createElement('p');
          postP.textContent = post.brief;
          postLi.appendChild(postP);

          weblogUl.appendChild(postLi);
        }            
      });
  </script>
</body>
</html>